(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,,,,,,,,function(e,t,n){e.exports=n.p+"static/media/model_icon.5b6e3166.svg"},function(e,t,n){e.exports=n.p+"static/media/operations_icon.c27d4702.svg"},function(e,t,n){e.exports=n.p+"static/media/simulate_icon.4b3eb9e4.svg"},function(e,t,n){e.exports=n.p+"static/media/export_icon.7c0c7e01.svg"},,function(e,t,n){e.exports=function(){return new Worker(n.p+"8651d2eb8b080a7af1ec.worker.js")}},function(e,t,n){e.exports=function(){return new Worker(n.p+"3f01e2f2591ae1c410f1.worker.js")}},function(e,t,n){e.exports=n(42)},,,,,,function(e,t,n){},,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(16),o=n.n(i),s=(n(25),n(3)),c=n(1),u=n(5),l=n(4),p=n(6),h=n(7),d=n.n(h),m=n(8),f=n(10),v=n(17),b=n.n(v),y=n(9),O=n.n(y),w=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this))).worker=n._createWorker(),n._onReady=e,n._cmdId=0,n._callbacks={},n.worker.onmessage=n._onMessage.bind(Object(f.a)(Object(f.a)(n))),n}return Object(p.a)(t,e),Object(c.a)(t,null,[{key:"create",value:function(){return new Promise(function(e,n){new t(e)})}},{key:"createWithModel",value:function(){var e=Object(m.a)(d.a.mark(function e(n){var a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.create();case 2:return a=e.sent,e.next=5,a.sendCommand("setModel",{modelBuffer:n.buffer,triangles:n.triangles});case 5:return e.abrupt("return",a);case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}]),Object(c.a)(t,[{key:"_createWorker",value:function(){return new b.a}},{key:"_onMessage",value:function(e){var t=e.data;"ready"!=t.type?t.event?this.emit(t.event,t.params):t.id&&this._callbacks[t.id]&&(this._callbacks[t.id](t),delete this._callbacks[t.id]):this._onReady(this)}},{key:"sendCommand",value:function(e,t){var n=this;return new Promise(function(a,r){var i=++n._cmdId;n._callbacks[i]=a,n.worker.postMessage({id:i,action:e,params:t})})}},{key:"destroy",value:function(){this.worker.terminate()}}]),t}(O.a),k=n(2),g=n(28),E=new(function(){function e(){Object(s.a)(this,e)}return Object(c.a)(e,[{key:"init",value:function(e){console.dir(e),this.clock=new k.Clock,this.scene=new k.Scene,this.camera=new k.PerspectiveCamera(60,window.innerWidth/window.innerHeight,1,1e3),this.camera.position.x=100,this.camera.position.y=100,this.camera.position.z=100,this.camera.lookAt(new k.Vector3(0,0,0));var t=new k.PointLight(16777215,1,0);t.position.set(500,150,0),this.scene.add(t);var n=new k.PointLight(16777215,1,0);n.position.set(-500,150,0),this.scene.add(n);var a=new k.PointLight(16777215,1,0);a.position.set(0,-150,500),this.scene.add(a);var r=new k.PointLight(16777215,1,0);r.position.set(0,-150,-500),this.scene.add(r),new k.PointLight(16777215,1,0).position.set(0,100,0),this.scene.add(r),this.addGrid(),this.renderer=new k.WebGLRenderer({canvas:e,antialias:!0}),this.controls=new g(this.camera,this.renderer.domElement),this.animate()}},{key:"addControls",value:function(){}},{key:"onWindowResize",value:function(){this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(window.innerWidth,window.innerHeight)}},{key:"animate",value:function(){this.render()}},{key:"render",value:function(){requestAnimationFrame(this.render.bind(this)),this.renderer.render(this.scene,this.camera)}},{key:"addGrid",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:200,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,r=new k.Group,i=new k.LineBasicMaterial({color:3355443,linewidth:.1}),o=new k.LineBasicMaterial({color:6710886,linewidth:2}),s=n/a,c=0;c<=e;c+=s){var u=new k.Geometry;u.vertices.push(new k.Vector3(c,0,0)),u.vertices.push(new k.Vector3(c,0,t));var l=new k.Line(u,c%n==0?o:i);r.add(l)}for(var p=0;p<=t;p+=s){var h=new k.Geometry;h.vertices.push(new k.Vector3(0,0,p)),h.vertices.push(new k.Vector3(e,0,p));var d=new k.Line(h,p%n==0?o:i);r.add(d)}this.scene.add(r)}},{key:"showModel",value:function(e){var t=new k.BufferGeometry;t.addAttribute("position",new k.BufferAttribute(e,3)),t.computeVertexNormals();var n=new k.MeshStandardMaterial({ambient:328965,color:3366143,specular:5592405,shininess:100});this.mesh=new k.Mesh(t,n),this.mesh.rotation.x=-Math.PI/2;var a=(new k.Box3).setFromObject(this.mesh).min;this.mesh.position.set(-1*a.x,-1*a.y,-1*a.z),this.scene.add(this.mesh)}},{key:"removeModel",value:function(){this.scene.remove(this.mesh),delete this.mesh}},{key:"modifyModel",value:function(e){this.mesh.geometry.attributes.position.array.fill(0),this.mesh.geometry.attributes.position.array.set(e),this.mesh.geometry.attributes.position.needsUpdate=!0,this.mesh.geometry.computeVertexNormals()}},{key:"removePath",value:function(e){var t="Path::".concat(e),n=this.scene.getObjectByName(t);this.scene.remove(n)}},{key:"showPath",value:function(e,t){var n="Path::".concat(e),a=new k.Group;a.name=n;for(var r=new k.MeshBasicMaterial({color:255}),i=new k.Geometry,o=t[0].pathType,s=0;s<t.length;s++){var c=t[s];if(i.vertices.push(new k.Vector3(c.start.x,c.start.z,c.start.y)),o!=c.pathType){var u=new k.Line(i,r);a.add(u),o=c.pathType,i=new k.Geometry;var l=0==o?255:65535;r=new k.MeshBasicMaterial({color:l}),i.vertices.push(new k.Vector3(c.start.x,c.start.z,c.start.y))}}var p=new k.Line(i,r);a.add(p),this.scene.add(a)}}]),e}()),j=0,C=function(){function e(t){Object(s.a)(this,e),this.pathBuffer=t,this.lineCount=t.length/4,this.id=j++}return Object(c.a)(e,[{key:"toThreeObject",value:function(){for(var e=new Float32Array(3*this.lineCount),t=new Float32Array(3*this.lineCount),n=[],a=0;a<this.lineCount;a++){a>0&&n.push(a-1,a);var r=4*a,i=3*a;switch(e[i]=this.pathBuffer[r+1],e[i+1]=this.pathBuffer[r+3],e[i+2]=this.pathBuffer[r+2],this.pathBuffer[r]){case 0:t[i]=255,t[i+1]=255,t[i+2]=255;break;case 1:t[i]=0,t[i+1]=255,t[i+2]=0}}var o=new k.BufferGeometry;o.setIndex(n),o.addAttribute("position",new k.BufferAttribute(e,3)),o.addAttribute("color",new k.BufferAttribute(t,3));var s=new k.LineBasicMaterial({vertexColors:k.VertexColors});return new k.LineSegments(o,s)}},{key:"show",value:function(){E.scene.add(this.toThreeObject())}}]),e}(),x="sweepline",M={sweepline:{resolution:.1,boundryOffset:5,direction:"X",tool:{diameter:3,length:40},stepoverPercent:50,zDepthMax:0,zDepthStart:50,zDepthStep:25}},N=0,S=function(){function e(t){var n=t.type,a=t.properties;Object(s.a)(this,e),this.id=++N,this.type=n||x,this.properties=a||M[this.type],this.path=null}return Object(c.a)(e,[{key:"generate",value:function(){var e=Object(m.a)(d.a.mark(function e(){var t,n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return V.emit("operationGenerateStart",this),E.removePath(this.id),e.next=4,w.createWithModel(V.model);case 4:return t=e.sent,e.next=7,t.sendCommand("generatePath",this.properties);case 7:n=e.sent,t.destroy(),this.path=new C(n.params.pathBuffer),this.path.show(),V.emit("operationGenerateStop",this);case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){E.removePath(this.id)}}]),e}(),P=function(){function e(t){Object(s.a)(this,e),this.buffer=t.modelBuffer,this.filename=t.filename,this.triangles=t.triangles,this.dimensions=t.dimensions,E.showModel(this.buffer)}return Object(c.a)(e,null,[{key:"create",value:function(){var t=Object(m.a)(d.a.mark(function t(n){var a,r;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w.create();case 2:return a=t.sent,t.next=5,a.sendCommand("parseModel",{file:n});case 5:return r=t.sent,a.destroy(),t.abrupt("return",new e(r.params));case 8:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}]),e}(),V=new(function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).call(this))).operations=[],e.model=null,e}return Object(p.a)(t,e),Object(c.a)(t,[{key:"getOperation",value:function(e){return this.operations.find(function(t){return t.id==e})}},{key:"addNewOperation",value:function(){var e=new S({});return this.operations.push(e),e}},{key:"setModel",value:function(){var e=Object(m.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.create(t);case 2:this.model=e.sent,this.emit("modelReady");case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"clearOperations",value:function(){this.operations.forEach(function(e){return e.destroy()}),this.operations=[]}},{key:"clearModel",value:function(){this.clearOperations(),this.model=null,E.removeModel()}}]),t}(O.a)),B=(n(29),function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t="Button".concat(this.props.enabled?"":" disabled");return r.a.createElement("div",{className:t,onClick:function(){e.props.enabled&&e.props.onClick()}},this.props.text)}}]),t}(a.Component));B.defaultProps={enabled:!0};var F=B,z=(n(30),function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={open:!0},n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"toggleHeader",value:function(){this.setState({open:!this.state.open})}},{key:"render",value:function(){var e=this;this.state.open;return r.a.createElement("div",{className:"TabbedSection"},r.a.createElement("div",{className:"tabbedHeader",onClick:function(){return e.toggleHeader()}},r.a.createElement("span",null,this.props.text),r.a.createElement("span",null,this.state.open?"\u25be":"\u25b4")),this.state.open&&r.a.createElement("div",{className:"tabbedContent"},this.props.children))}}]),t}(a.Component)),D=(n(31),function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;V.on("modelReady",function(){return e.forceUpdate()})}},{key:"onChange",value:function(){var e=Object(m.a)(d.a.mark(function e(t){var n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.target.files[0],e.next=3,V.setModel(n);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"clearModel",value:function(){var e=Object(m.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:V.clearModel(),this.forceUpdate();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement("div",{className:"SideMenu ModelMenu"},r.a.createElement("div",{className:"menuHeader"},r.a.createElement("img",{src:n(12)}),"Model"),this.renderContent)}},{key:"renderContent",get:function(){var e=this;if(V.model){var t=V.model;return r.a.createElement("div",null,r.a.createElement(z,{text:"Model"},r.a.createElement("div",{className:"modelProperties"},r.a.createElement("div",null,r.a.createElement("span",null,"Filename"),r.a.createElement("span",null,t.filename)),r.a.createElement("div",null,r.a.createElement("span",null,"Polygons"),r.a.createElement("span",null,t.triangles)),r.a.createElement("fieldset",{className:"dimensionsField"},r.a.createElement("legend",null,"Dimensions"),r.a.createElement("div",null,r.a.createElement("span",null,"X"),r.a.createElement("span",null,t.dimensions.x," mm")),r.a.createElement("div",null,r.a.createElement("span",null,"Y"),r.a.createElement("span",null,t.dimensions.y," mm")),r.a.createElement("div",null,r.a.createElement("span",null,"Z"),r.a.createElement("span",null,t.dimensions.z," mm"))),r.a.createElement("div",null,r.a.createElement(F,{text:"Clear",onClick:function(){return e.clearModel()}})))))}return r.a.createElement(z,{text:"Model"},r.a.createElement("div",{className:"modelInput"},r.a.createElement("input",{type:"file",onChange:this.onChange.bind(this),accept:".stl"})))}}]),t}(a.Component)),W=(n(32),function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"createNew",value:function(){var e=V.addNewOperation();this.selectOperation(e.id)}},{key:"selectOperation",value:function(e){this.props.onOperationSelect(e)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"OperationList"},r.a.createElement("div",{className:"listContainer"},this.listContent),r.a.createElement("div",{className:"buttonContainer"},r.a.createElement(F,{text:"New",onClick:function(){return e.createNew()}})))}},{key:"listContent",get:function(){var e=this;return V.operations.map(function(t){var n=t.id===e.props.selectedOperation;return r.a.createElement("div",{className:"operation"+(n?" selected":""),key:t.id,onClick:function(){return e.selectOperation(t.id)}},r.a.createElement("span",{className:"opName"},t.type),r.a.createElement("div",{className:"opButtons"}))})}}]),t}(a.Component)),T=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"propertyField"},r.a.createElement("span",null,this.props.field.name),r.a.createElement("span",null,r.a.createElement("input",{type:"number",value:this.props.value,onChange:function(t){return e.props.onChange(Number(t.target.value))},min:this.props.field.minValue,max:this.props.field.maxValue,step:this.props.field.stepValue}),r.a.createElement("span",{className:"propSuffix"},this.props.field.suffix)))}}]),t}(a.Component),A=(n(33),{diameter:{name:"Diameter",type:"number",minValue:.1,stepValue:.01,suffix:"mm"},length:{name:"Length",type:"number",minValue:.1,stepValue:.01,suffix:"mm"}}),G=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"onUpdate",value:function(){}},{key:"render",value:function(){var e=this;return r.a.createElement("fieldset",{className:"ToolField"},r.a.createElement("legend",null,"Tool"),r.a.createElement("div",{className:"propertyField"},r.a.createElement("span",null,"Endmill Type"),r.a.createElement("select",null,r.a.createElement("option",null,"Flat nose"),r.a.createElement("option",null,"Ball nose"))),r.a.createElement(T,{field:A.diameter,value:this.props.tool.diameter,onChange:function(t){return e.props.onFieldChange("diameter",t)}}),r.a.createElement(T,{field:A.length,value:this.props.tool.length,onChange:function(t){return e.props.onFieldChange("length",t)}}))}}]),t}(a.Component),L={resolution:{name:"Resolution",type:"number",minValue:.01,maxValue:5,stepValue:.01,suffix:"mm"},boundryOffset:{name:"Boundry Offset",type:"number",minValue:0,suffix:"mm"},direction:{name:"Direction",options:["x","y"]},stepoverPercent:{name:"Stepover",type:"number",minValue:1,maxValue:100,stepValue:1,suffix:"%"},zDepthMax:{name:"Z Depth Stop",type:"number",minValue:0,suffix:"mm"},zDepthStart:{name:"Z Depth Start",type:"number",minValue:0,suffix:"mm"},zDepthStep:{name:"Z Depth Stepdown",type:"number",minValue:.01,suffix:"mm"}},_=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state=Object.assign({hasBeenUpdated:!1},n.props.operation.properties),n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"save",value:function(){var e=this;Object.keys(L).forEach(function(t){e.props.operation.properties[t]=e.state[t]}),this.setState({hasBeenUpdated:!1})}},{key:"generate",value:function(){this.save(),this.props.operation.generate(this.props.operation.id)}},{key:"updateToolValue",value:function(e,t){var n={hasBeenUpdated:!0,tool:this.state.tool};n.tool[e]=t,this.setState(n)}},{key:"updateFieldValue",value:function(e,t){var n={hasBeenUpdated:!0};n[e]=t,this.setState(n)}},{key:"dropdownFieldFor",value:function(e){var t=this,n=L[e];return r.a.createElement("div",{className:"propertyField"},r.a.createElement("span",null,n.name),r.a.createElement("span",null,r.a.createElement("select",{value:this.state[e],onChange:function(n){return t.updateFieldValue(e,n.target.value)}},n.options.map(function(e,t){return r.a.createElement("option",{value:e,key:t},e.toUpperCase())}))))}},{key:"render",value:function(){var e=this;this.props.operation;return r.a.createElement("div",{className:"SubProperties"},r.a.createElement(G,{tool:this.state.tool,onFieldChange:function(t,n){return e.updateToolValue(t,n)}}),r.a.createElement(T,{field:L.resolution,value:this.state.resolution,onChange:function(t){return e.updateFieldValue("resolution",t)}}),this.dropdownFieldFor("direction"),r.a.createElement(T,{field:L.boundryOffset,value:this.state.boundryOffset,onChange:function(t){return e.updateFieldValue("boundryOffset",t)}}),r.a.createElement(T,{field:L.stepoverPercent,value:this.state.stepoverPercent,onChange:function(t){return e.updateFieldValue("stepoverPercent",t)}}),r.a.createElement(T,{field:L.zDepthStart,value:this.state.zDepthStart,onChange:function(t){return e.updateFieldValue("zDepthStart",t)}}),r.a.createElement(T,{field:L.zDepthMax,value:this.state.zDepthMax,onChange:function(t){return e.updateFieldValue("zDepthMax",t)}}),r.a.createElement(T,{field:L.zDepthStep,value:this.state.zDepthStep,onChange:function(t){return e.updateFieldValue("zDepthStep",t)}}),this.buttonContent)}},{key:"buttonContent",get:function(){var e=this;return r.a.createElement("div",{className:"buttonContainer"},r.a.createElement(F,{text:"Save",onClick:function(){return e.save()},enabled:this.state.hasBeenUpdated}),r.a.createElement(F,{text:"Generate",onClick:function(){return e.generate()}}))}}]),t}(a.Component),H=(n(34),function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return null==this.props.selectedOperation?r.a.createElement("div",{className:"OperationProperties"},r.a.createElement("div",{className:"message"},"Select an operation to edit")):r.a.createElement("div",{className:"OperationProperties"},this.propertiesContent)}},{key:"propertiesContent",get:function(){var e=V.getOperation(this.props.selectedOperation);switch(e.type){case"sweepline":return r.a.createElement(_,{operation:e})}}}]),t}(a.Component)),U=(n(35),function(e){function t(e){var n;Object(s.a)(this,t),n=Object(u.a)(this,Object(l.a)(t).call(this,e));var a=V.operations.length>0?V.operations[0].id:null;return n.state={selectedOperation:a},n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"openOperation",value:function(e){this.setState({selectedOperation:e})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"SideMenu OperationsMenu"},r.a.createElement("div",{className:"menuHeader"},r.a.createElement("img",{src:n(13)}),"Operations"),r.a.createElement(z,{text:"Operations"},r.a.createElement(W,{onOperationSelect:function(t){return e.openOperation(t)},selectedOperation:this.state.selectedOperation})),r.a.createElement(z,{text:"Properties"},r.a.createElement(H,{selectedOperation:this.state.selectedOperation})))}}]),t}(a.Component)),I=n(18),R=n.n(I),Z=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"_createWorker",value:function(){return new R.a}},{key:"setTool",value:function(){var e=Object(m.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sendCommand("setTool",{tool:t});case 2:e.sent;case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"toolCollision",value:function(){var e=Object(m.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sendCommand("toolCollision",{toolPosition:t});case 2:e.sent;case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getPolygons",value:function(){var e=Object(m.a)(d.a.mark(function e(){var t;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sendCommand("getSimPolygons",{});case 2:return t=e.sent,e.abrupt("return",t.params);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"runOperationSimulation",value:function(){var e=Object(m.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sendCommand("runOperationSimulation",{tool:{diameter:t.properties.tool.diameter,length:t.properties.tool.length,resolution:.1},pathBuffer:t.path.pathBuffer,updateInterval:Math.floor(1e3/15)});case 2:e.sent;case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}],[{key:"create",value:function(){return new Promise(function(e,n){new t(e)})}},{key:"createForSimulation",value:function(){var e=Object(m.a)(d.a.mark(function e(n){var a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.create();case 2:return a=e.sent,e.next=5,a.sendCommand("initSimulation",{stock:n});case 5:return e.abrupt("return",a);case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}]),t}(w),J=function(){function e(t,n){Object(s.a)(this,e),this.id=t;var a=new Float32Array(3e5);a.fill(0),a.set(n),this.vertexAttribute=new k.BufferAttribute(a,3).setDynamic(!0);var r=new k.BufferGeometry;r.addAttribute("position",this.vertexAttribute),r.computeVertexNormals();var i=new k.MeshStandardMaterial({ambient:328965,color:3366143,specular:5592405,shininess:100}),o=new k.Mesh(r,i);o.rotation.x=-Math.PI/2;var c=(new k.Box3).setFromObject(o).min;o.position.set(-1*c.x,-1*c.y,-1*c.z),E.scene.add(o),this.mesh=o}return Object(c.a)(e,[{key:"update",value:function(e){var t=this.vertexAttribute.array;t.fill(0),t.set(e),this.vertexAttribute.needsUpdate=!0,this.mesh.geometry.computeVertexNormals()}}]),e}(),X=function(){function e(){Object(s.a)(this,e),this.subObjects={}}return Object(c.a)(e,[{key:"updateModel",value:function(e){var t=this;e.forEach(function(e){return t.updateGroup(e)})}},{key:"updateGroup",value:function(e){var t=e.id,n=e.vertices;this.subObjects[t]?this.subObjects[t].update(n):this.subObjects[t]=new J(t,n)}}]),e}(),q=new(function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).call(this))).model=new X,e}return Object(p.a)(t,e),Object(c.a)(t,[{key:"initialize",value:function(){var e=Object(m.a)(d.a.mark(function e(t){var n=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return E.removeModel(),this.stock={size:{x:V.model.dimensions.x,y:V.model.dimensions.y,z:V.model.dimensions.z}},e.next=4,Z.createForSimulation(this.stock);case 4:return this.simWorker=e.sent,e.next=7,this.getFullPolygons();case 7:this.simWorker.on("polygonUpdate",function(e){return n.updateModelEvent(e.polygonBuffer)});case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"runOperation",value:function(){var e=Object(m.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.simWorker.runOperationSimulation(t);case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getFullPolygons",value:function(){var e=Object(m.a)(d.a.mark(function e(){var t;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.simWorker.getPolygons();case 2:t=e.sent,this.model.updateModel(t);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"updateModelEvent",value:function(e){this.model.updateModel(e)}}]),t}(O.a)),Q=(n(36),function(e){function t(e){var n;return Object(s.a)(this,t),n=Object(u.a)(this,Object(l.a)(t).call(this,e)),q.initialize(),n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"test",value:function(){q.runOperation(V.operations[0])}},{key:"render",value:function(){return r.a.createElement("div",{className:"SideMenu SimulateMenu"},r.a.createElement("div",{className:"menuHeader"},r.a.createElement("img",{src:n(14)}),"Simulate"),this.renderContent)}},{key:"renderContent",get:function(){var e=this;return r.a.createElement(z,{text:"Test"},r.a.createElement("div",{className:"modelInput"},r.a.createElement("button",{onClick:function(){return e.test()}},"Test")))}}]),t}(a.Component)),Y=(n(37),function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"SideMenu ExportMenu"},r.a.createElement("div",{className:"menuHeader"},r.a.createElement("img",{src:n(15)}),"Export"))}}]),t}(a.Component)),$=(n(38),function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={currentMenu:"model"},n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"onHeaderClick",value:function(e){this.setState({currentMenu:e})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"Sidebar"},r.a.createElement("div",{className:"headers"},r.a.createElement("div",{onClick:function(){return e.onHeaderClick("model")},style:{backgroundColor:"#587291"}},r.a.createElement("img",{src:n(12)}),"Model"),r.a.createElement("div",{style:{backgroundColor:"#2F97C1"},onClick:function(){return e.onHeaderClick("operations")}},r.a.createElement("img",{src:n(13)}),"Operations"),r.a.createElement("div",{style:{backgroundColor:"#1CCAD8"},onClick:function(){return e.onHeaderClick("simulate")}},r.a.createElement("img",{src:n(14)}),"Simulate"),r.a.createElement("div",{style:{backgroundColor:"#B4656F"},onClick:function(){return e.onHeaderClick("export")}},r.a.createElement("img",{src:n(15)}),"Export")),r.a.createElement("div",{className:"menuItem"},this.currentMenuElement))}},{key:"currentMenuElement",get:function(){switch(this.state.currentMenu){case"model":return r.a.createElement(D,null);case"operations":return r.a.createElement(U,null);case"simulate":return r.a.createElement(Q,null);case"export":return r.a.createElement(Y,null)}}}]),t}(a.Component)),K=(n(39),function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={operations:[],completedOperations:[]},n.removeCompletedTimer=null,n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){V.on("operationGenerateStart",this.addOperation.bind(this)),V.on("operationGenerateStop",this.stopOperation.bind(this))}},{key:"addOperation",value:function(e){this.state.operations.push(e),this.forceUpdate()}},{key:"stopOperation",value:function(e){var t=this;clearTimeout(this.removeCompletedTimer),this.state.completedOperations.push(this.state.operations.find(function(t){return t.id==e.id})),this.state.operations=this.state.operations.filter(function(t){return t.id!=e.id}),this.forceUpdate(),this.removeCompletedTimer=setTimeout(function(){t.state.completedOperations=[]},300)}},{key:"cancelOperation",value:function(e){}},{key:"operationElement",value:function(e){var t=this;return r.a.createElement("div",{className:"pendingOp"},r.a.createElement("div",null,r.a.createElement("span",null,"Generating ",e.name),r.a.createElement("span",{onClick:function(){return t.cancelOperation(e)}},"cancel")),r.a.createElement("div",{className:"loadingSpinner"}))}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:this.active?"PendingOperations active":"PendingOperations inactive"},this.state.operations.map(function(t){return e.operationElement(t)}),this.state.completedOperations.map(function(t){return e.operationElement(t)}))}},{key:"active",get:function(){return this.state.operations.length>0}}]),t}(a.Component)),ee=(n(40),function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){window.onresize=this.resizeCanvas.bind(this),E.init(this.canvasElement),this.resizeCanvas()}},{key:"resizeCanvas",value:function(){this.canvasElement.style.width="100%",this.canvasElement.style.height="100%",this.canvasElement.width=this.canvasElement.offsetWidth,this.canvasElement.height=this.canvasElement.offsetHeight,E.onWindowResize()}},{key:"render",value:function(){var e=this;return r.a.createElement("canvas",{className:"WebglDisplay",ref:function(t){return e.canvasElement=t}})}}]),t}(a.Component)),te=(n(41),function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement($,null),r.a.createElement(ee,null),r.a.createElement(K,null))}}]),t}(a.Component)),ne=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function ae(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}o.a.render(r.a.createElement(te,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/machinist",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("/machinist","/service-worker.js");ne?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):ae(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):ae(e)})}}()}],[[19,1,2]]]);
//# sourceMappingURL=main.f64153ed.chunk.js.map